<Page
    x:Class="DrawingApp.UI.Pages.DashboardPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <ScrollViewer>
        <StackPanel Padding="24" Spacing="16">

            <TextBlock Text="Dashboard" FontSize="24" FontWeight="SemiBold"/>

            <Button Content="Load Stats"
                    HorizontalAlignment="Left"
                    Command="{Binding LoadCommand}"/>

            <!-- ===== Summary cards ===== -->
            <Grid ColumnDefinitions="*,*,*,*"
                  RowDefinitions="Auto"
                  ColumnSpacing="12">

                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        CornerRadius="8" Padding="12">
                    <StackPanel>
                        <TextBlock Text="Total Boards" Opacity="0.7"/>
                        <TextBlock Text="{Binding Stats.TotalBoards}" FontSize="22" FontWeight="SemiBold"/>
                    </StackPanel>
                </Border>

                <Border Grid.Column="1"
                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        CornerRadius="8" Padding="12">
                    <StackPanel>
                        <TextBlock Text="Total Shapes" Opacity="0.7"/>
                        <TextBlock Text="{Binding Stats.TotalShapes}" FontSize="22" FontWeight="SemiBold"/>
                    </StackPanel>
                </Border>

                <Border Grid.Column="2"
                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        CornerRadius="8" Padding="12">
                    <StackPanel>
                        <TextBlock Text="Total Templates" Opacity="0.7"/>
                        <TextBlock Text="{Binding Stats.TotalTemplates}" FontSize="22" FontWeight="SemiBold"/>
                    </StackPanel>
                </Border>

                <Border Grid.Column="3"
                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        CornerRadius="8" Padding="12">
                    <StackPanel>
                        <TextBlock Text="Avg Shapes / Board" Opacity="0.7"/>
                        <TextBlock Text="{Binding Stats.AvgShapesPerBoard}" FontSize="22" FontWeight="SemiBold"/>
                    </StackPanel>
                </Border>
            </Grid>

            <!-- ===== Shape usage chart ===== -->
            <StackPanel Spacing="8">
                <TextBlock Text="Shape Type Usage"
                           FontSize="18" FontWeight="SemiBold"/>

                <ItemsControl ItemsSource="{Binding ShapeUsageBars}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Grid ColumnDefinitions="160,*,80" Padding="4">
                                <TextBlock Text="{Binding Label}"
                                           VerticalAlignment="Center"/>

                                <ProgressBar Grid.Column="1"
                                             Height="12"
                                             Minimum="0"
                                             Maximum="1"
                                             Value="{Binding Ratio}"
                                             VerticalAlignment="Center"/>

                                <TextBlock Grid.Column="2"
                                           Text="{Binding PercentText}"
                                           HorizontalAlignment="Right"
                                           VerticalAlignment="Center"/>
                            </Grid>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>

            <!-- ===== Template distribution chart ===== -->
            <StackPanel Spacing="8">
                <TextBlock Text="Templates by Shape Type"
                           FontSize="18" FontWeight="SemiBold"/>

                <ItemsControl ItemsSource="{Binding TemplateUsageBars}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Grid ColumnDefinitions="160,*,80" Padding="4">
                                <TextBlock Text="{Binding Label}"
                                           VerticalAlignment="Center"/>

                                <ProgressBar Grid.Column="1"
                                             Height="12"
                                             Minimum="0"
                                             Maximum="1"
                                             Value="{Binding Ratio}"
                                             VerticalAlignment="Center"/>

                                <TextBlock Grid.Column="2"
                                           Text="{Binding PercentText}"
                                           HorizontalAlignment="Right"
                                           VerticalAlignment="Center"/>
                            </Grid>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>

            <!-- ===== Top boards ===== -->
            <StackPanel Spacing="8">
                <TextBlock Text="Top boards with most shapes"
                           FontSize="18" FontWeight="SemiBold"/>

                <ItemsControl ItemsSource="{Binding Stats.TopBoards}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Grid ColumnDefinitions="*,Auto" Padding="4">
                                <TextBlock Text="{Binding Name}" />
                                <TextBlock Grid.Column="1"
                                           Text="{Binding ShapeCount}"
                                           Opacity="0.7"
                                           Margin="12,0,0,0"/>
                            </Grid>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>

        </StackPanel>
    </ScrollViewer>
</Page>
